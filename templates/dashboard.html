{% extends "base.html" %}
{% block content %}
  <div class="mb-4">
    <h2 class="fw-bold mb-1">האזור האישי</h2>
    <p class="text-muted mb-0">כל מה שחשוב לך במקום אחד: התאמות, מלגות ועדכונים.</p>
  </div>

  <div class="row g-4">
    <div class="col-md-4">
      <a class="dashboard-card card-link h-100" href="{{ url_for('questionnaire') }}">
        <div class="icon-badge mb-3"><i class="bi bi-ui-checks-grid"></i></div>
        <h5 class="fw-bold">התאמת מלגות אישית</h5>
        <p class="text-muted mb-0">ענה על כמה שאלות וקבל התאמה חכמה למלגות שמגיעות לך</p>
      </a>
    </div>
    <div class="col-md-4">
      <a class="dashboard-card card-link h-100" href="{{ url_for('scholarships') }}">
        <div class="icon-badge mb-3"><i class="bi bi-mortarboard"></i></div>
        <h5 class="fw-bold">כל המלגות</h5>
        <p class="text-muted mb-0">רשימת מלגות מסודרת עם מועדים ומידע מרכזי</p>
      </a>
    </div>
    <div class="col-md-4">
      <a class="dashboard-card card-link h-100" href="{{ url_for('updates') }}">
        <div class="icon-badge mb-3"><i class="bi bi-bell"></i></div>
        <h5 class="fw-bold">עדכונים</h5>
        <p class="text-muted mb-0">התראות, דדליינים והודעות חשובות</p>
      </a>
    </div>
  </div>

  {% set status_class = {
    'מעוניין': 'status-interest',
    'לא מעוניין': 'status-muted',
    'הגשתי': 'status-progress',
    'התקבלתי': 'status-success'
  } %}

  <div class="row g-4 mt-2">
    <div class="col-lg-6">
      <div class="card-soft p-4 h-100">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <h5 class="fw-bold mb-0">המלגות שלי</h5>
          <a class="btn btn-outline-primary btn-sm" href="{{ url_for('my_scholarships') }}">לכל המלגות</a>
        </div>
        <div class="mini-list">
          {% for item in scholarships %}
            <a class="mini-list-item {{ status_class.get(item.status, 'status-progress') }}" href="{{ url_for('my_scholarships') }}">
              <span class="fw-semibold">{{ item.scholarship_title }}</span>
              <span class="small text-muted">{{ item.status }}</span>
            </a>
          {% else %}
            <div class="text-muted">עדיין אין התאמות. מלא את השאלון.</div>
          {% endfor %}
        </div>
      </div>
    </div>
    <div class="col-lg-6">
      <div class="card-soft p-4 h-100">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <h5 class="fw-bold mb-0">עדכונים אחרונים</h5>
          <a class="btn btn-outline-primary btn-sm" href="{{ url_for('updates') }}">לכל העדכונים</a>
        </div>
        <div class="mini-list">
          {% for note in notifications %}
            <a class="mini-list-item" href="{{ url_for('updates', open=note.id) }}">
              <span class="fw-semibold">{{ note.title }}</span>
              <span class="small text-muted">{{ note.sender_label }}</span>
            </a>
          {% else %}
            <div class="text-muted">אין עדכונים חדשים.</div>
          {% endfor %}
        </div>
        {% if unread_notifications and unread_notifications > 0 %}
          <div class="mt-3 text-danger small">יש לך {{ unread_notifications }} עדכונים שלא נקראו.</div>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}
